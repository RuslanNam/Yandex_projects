# `Проект`: Построение модели определения стоимости автомобиля

## Описание проекта и Цель
Сервис по продаже автомобилей с пробегом разрабатывает приложение для привлечения новых клиентов, где можно будет узнать рыночную стоимость своего автомобиля.

Заказчику важны:
* качество предсказания;
* скорость предсказания;
* время обучения.

## Описание датасета
Имеются исторические данные: технические характеристики, комплектации и цены автомобилей.
## Применяемые библиотеки
`pandas` `scikit-learn` `matplotlib.pyplot` `seaborn` `catboost` `lightgbm`
# Основные выводы
Первым делом изучив данные, сразу было замечено, что в следующих переменных неадекватные значения:
* Price: 0 евро
* RegistrationYear: мин год 1000, и макс год 9999
* Power: от 0 л.с. до 20000 л.с.
* RegistrationMonth: 0-ой месяц Следовательно нужно посмотреть и отфильтровать данные от аномалий

Поэтому была предпринята следующая фильтрация:
* Price > 1000, хотя и за 2000 вывглядит как выброс, но все же оставим;
* 1990 <= RegistrationYear <= 2022, думаю будет разумно не заглядывать в будущее и слишком уходить в прошлое.
* 50 < Power < 1000, хотя даже так в среднем мы вряд ли найдем машинку с 50 лошадями и монстра с табуном из примерно 1000 лошадей.
* RegistrationMonth > 0, нулевого месяца не знаем

Аномалии удалены, теперь можно удалить признаки, никак не влияющие на прогноз цены авто.  

Далее шаги по обработке данных и подготовке признаков были такие:
* Было замечено, что половина признаков имеет null-значения, которые следует обработать: `data.fillna('None')`  
* Были замечены дубликаты, которые были также удалены
* Увидели, что у есть ряд категориальных признаков, которые нужно перевести в числа, и сделали через `OHE`.
* Разделили данные на выборки через `train_test_split`
* Привели к одному масштабу количественные признаки

Высчитаем скорость обучения и предсказания - для этого я написал функцию, выполняющую эти задачи.  
Теперь на данных можно обучать модели.  
**Наилучшая модель в данном исследовании - `LGBMRegressor`.**  
Несмотря на то, что `CatBoost` проявил несколько бОльшую скорость, `LightGBM` показал наилучшее качество предсказаний.  
При этом нелишним будет указать, что наиболее важными признаками моделями `CatBoost` и `LightGBM` были выделены: мощность, время регистрации авто и пробег, - что вполне соответсвует действительности при определении цены авто на вторичном рынке
### По итогу наилучшая модель показала более чем впечатлящий показатель качества с RMSE равным 1675.21
